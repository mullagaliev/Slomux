# Тестовое задание для Middle JavaScript-разработчик в CSSSR

## Исходный текст задания

> [Slomux](https://codepen.io/daynin/pen/KXemyg) — упрощённая, сломанная реализация Flux.
> Перед вами небольшое приложение, написанное на React + Slomux.
> Исправьте ошибки и потенциально проблемный код, почините приложение и прокомментируйте своё решение.

> Ограничения по времени: ~ 25 минут

## Список найденных ошибок

> (снизу вверх по коду)
- Блок components:
	* Component "ToDoComponent"
		1. У <label> не хватает атрибута "htmlFor", а у <input> атрибута "id". Из за этого не встает фокус на <input> при клике по <label>.
		2. Форма не отправляется по клику на клавишу "enter". Одно из решений - добавить форму, повесить на неё обработчик и добавить кнопки тип submit.
		3. В списке <ul> для <li> не хватает props "key". Важно для оптимальной работы React.
		4. Метод updateText ошибка в логике (this.state.todoText = value), нельзя использовать прямой доступ к свойствам состояния. Решение - использование this.setState(...).
		5. Метод addTodo та же проблема (см. пункт 4).
		6. Методы updateText и addTodo теряют контекст при вызове. Одно из решений - переход на стрелочные(анонимные) функции.
		7. Возможная ошибка в логике - добавление заданий с пустыми названиями. Решение проверка на пустые строки
- Блок reducers:
	1. Проблема с мутабильностью в строке (state.push(action.payload)). Одно из решений - создание копии стейта (в данной ситуации через state.slice()) и работа с ним, а не со старым стейтом.
- Реализация "Slomux":
	* Provider
		1. Возможная проблема - работа с глобальным объектом window в строке (window.store = this.props.store), делает код привязанным к платформе. Решение - использование Context.
		2. Ошибка в методе render, строка (return this.props.children), а должно быть React.Children.only(this.props.children). Метод должен возвращать одного ребенка.
		3.
	* connect
		1. В классе "Врапер" используется необъявленная переменная store. Решение - объявление переменной и получение её значения (в исходном варианте из window.store, в исправленном из this.context).
		2. Component теряет свои собственные props после "коннекта". Решение - передача props в <Component {...this.props} ...>.
		3. Ошибка в строке использовании store.subscribe(...). Компонент подписывается на обновления, но не отписывается от них. Решение - сохранение результата вызова store.subscribe(...) и вызов этой функции в componentWillUnmount (для отписки от обновлений).
			p.s store.subscribe должен возвращать метод функцию для отписки, но об этом позже
	* createStore
		1. Можно поменять createStore на обычную функцию вместо стрелочной (не критично).
		2. Возможная ошибка - Строка (const listeners = []) вводит в заблуждение, говоря что массив "listeners" не будет изменятся, но массива меняется при добавлении подписчиков. Решение заменит const на let (или var).
		3. Функция dispatch не возвращает action после своего выполнения. Решение добавить (return action;) в функцию dispatch.
		4. Функция subscribe не возвращает функцию отписки. Решение - добавить функцию отписки и вернуть её в результат

## Запуск

1. `npm i`
2. `npm start`

## Создание билда
1. `npm i`
2. `npm run build`

## Прочее
> Project bootstrapped using create-react-app
> Исходный текст [задания](https://csssr.ru/jobs/middle-js-developer)
